<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Miiro Emmanuel">

<title>Plots for UFO sightings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="UFO plots_files/libs/clipboard/clipboard.min.js"></script>
<script src="UFO plots_files/libs/quarto-html/quarto.js"></script>
<script src="UFO plots_files/libs/quarto-html/popper.min.js"></script>
<script src="UFO plots_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="UFO plots_files/libs/quarto-html/anchor.min.js"></script>
<link href="UFO plots_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="UFO plots_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="UFO plots_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="UFO plots_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="UFO plots_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Plots for UFO sightings</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Miiro Emmanuel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">6/20/23</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"sf"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rnaturalearth"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rnaturalearthdata"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>ufo_sightings <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ufo_sightings.csv"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>places <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"places.csv"</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>day_parts_map <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"day_parts_map.csv"</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="sightings-of-unidentified-flying-objects-ufos" class="level1">
<h1>Sightings of Unidentified Flying Objects (UFOs)</h1>
<p>The data on sightings of UFOs was collated by <a href="https://github.com/jonthegeek/apis/">Jon Harmon</a> from the <a href="https://nuforc.org/webreports/ndxshape.html">National UFO Reporting Center</a>. He enriched the data with additional features. It was provided as part of the weekly <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-06-20/readme.md">TidyTuesday challenge</a>.</p>
<section id="structure-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="structure-of-the-data">Structure of the data</h2>
<p>The data has 96429 observations. It was provided in 3 parts:</p>
<ol type="1">
<li>ufo_sightings (showing the first 12 observations)</li>
</ol>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ufo_sightings) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 41%">
<col style="width: 4%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">reported_date_time</th>
<th style="text-align: left;">reported_date_time_utc</th>
<th style="text-align: left;">posted_date</th>
<th style="text-align: left;">city</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">country_code</th>
<th style="text-align: left;">shape</th>
<th style="text-align: left;">reported_duration</th>
<th style="text-align: right;">duration_seconds</th>
<th style="text-align: left;">summary</th>
<th style="text-align: left;">has_images</th>
<th style="text-align: left;">day_part</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2022-08-29 06:03:00</td>
<td style="text-align: left;">2022-08-29 06:03:00</td>
<td style="text-align: left;">2022-09-09</td>
<td style="text-align: left;">Pinehurst</td>
<td style="text-align: left;">NC</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">15 mins</td>
<td style="text-align: right;">900</td>
<td style="text-align: left;">Saw multi color object above horizon.</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">night</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-08-20 01:51:00</td>
<td style="text-align: left;">2022-08-20 01:51:00</td>
<td style="text-align: left;">2022-10-08</td>
<td style="text-align: left;">Rapid City</td>
<td style="text-align: left;">MI</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">1 minute</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">An object in the shape of a straight line about an inch from our viewing area moving slowly across the sky</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">nautical dusk</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-08-13 05:30:00</td>
<td style="text-align: left;">2022-08-13 05:30:00</td>
<td style="text-align: left;">2022-09-09</td>
<td style="text-align: left;">Cleveland</td>
<td style="text-align: left;">OH</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2 hours</td>
<td style="text-align: right;">172800</td>
<td style="text-align: left;">Tone in the air.</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">night</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-08-06 21:00:00</td>
<td style="text-align: left;">2022-08-06 21:00:00</td>
<td style="text-align: left;">2022-09-09</td>
<td style="text-align: left;">Bloomington</td>
<td style="text-align: left;">IN</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">30 seconds</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">Black tic-tac shaped ufo. Moved with insane speed</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">afternoon</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-08-04 07:40:00</td>
<td style="text-align: left;">2022-08-04 07:40:00</td>
<td style="text-align: left;">2022-09-09</td>
<td style="text-align: left;">Irvine</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3 minutes</td>
<td style="text-align: right;">180</td>
<td style="text-align: left;">Two alien were scanning me</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">night</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-07-22 16:00:00</td>
<td style="text-align: left;">2022-07-22 16:00:00</td>
<td style="text-align: left;">2022-09-09</td>
<td style="text-align: left;">Moore</td>
<td style="text-align: left;">OK</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">10 minutes</td>
<td style="text-align: right;">600</td>
<td style="text-align: left;">Long cigar solid shaped craft with light beam</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">morning</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="2" type="1">
<li>places (showing the first 12 observations)</li>
</ol>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(places) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 80%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 1%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">city</th>
<th style="text-align: left;">alternate_city_names</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">country</th>
<th style="text-align: left;">country_code</th>
<th style="text-align: right;">latitude</th>
<th style="text-align: right;">longitude</th>
<th style="text-align: left;">timezone</th>
<th style="text-align: right;">population</th>
<th style="text-align: right;">elevation_m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pinehurst</td>
<td style="text-align: left;">Pajnkherst,bynhwrst,pynhwrst karwlynay shmaly,Пајнхерст,بينهورست,پینهورست، کارولینای شمالی</td>
<td style="text-align: left;">NC</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">35.19543</td>
<td style="text-align: right;">-79.46948</td>
<td style="text-align: left;">America/New_York</td>
<td style="text-align: right;">15752</td>
<td style="text-align: right;">160</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rapid City</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">MI</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">44.83445</td>
<td style="text-align: right;">-85.28256</td>
<td style="text-align: left;">America/Detroit</td>
<td style="text-align: right;">1352</td>
<td style="text-align: right;">192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cleveland</td>
<td style="text-align: left;">CLE,Cleaveland,Cleveland,Forest City,Klevalehnd,Kliulend,Klivelant,Klivland,Klivlandas,Klivlando,Klivlend,Klivlenda,Klīvlenda,ka fu lan,ke li fu lan,keullibeullaendeu,kilivlant,klebhilyanda,klivhalanda,klyfland,klywlnd,kuriburando,qlyblnd,Κλίβελαντ,Клевалэнд,Кливланд,Кливленд,Клівленд,Кліўленд,Քլիվլենդ,קליבלנד,קליוולאנד,كليفلاند,کلیولند,کلیولینڈ، اوہائیو,क्लीव्हलंड,ক্লেভিল্যান্ড,கிளீவ்லன்ட்,คลีฟแลนด์,კლივლენდი,クリーブランド,克利夫兰,克里夫蘭,卡夫蘭,클리블랜드</td>
<td style="text-align: left;">OH</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">41.49950</td>
<td style="text-align: right;">-81.69541</td>
<td style="text-align: left;">America/New_York</td>
<td style="text-align: right;">388072</td>
<td style="text-align: right;">199</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bloomington</td>
<td style="text-align: left;">BMG,Bloomington,Blumington,Blumingtona,Blumingtun,Blūmingtona,beullumingteon,blumintana,blwmnghtwn,blwmyngtwn,blwmyngtwn ayndyana,bu lu ming dun,buruminton,Блумингтон,Блумингтън,Блумінгтон,בלומינגטון,بلومنغتون,بلومنگٹن، انڈیانا,بلومینگتون، ایندیانا,ব্লুমিংটন,ブルーミントン,布卢明顿,블루밍턴</td>
<td style="text-align: left;">IN</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">39.16533</td>
<td style="text-align: right;">-86.52639</td>
<td style="text-align: left;">America/Indiana/Indianapolis</td>
<td style="text-align: right;">84067</td>
<td style="text-align: right;">235</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Irvine</td>
<td style="text-align: left;">rvajn,Ervajn,Irvajn,Irvin,Irvinas,Irvine,abain,arfayn,arwayn,arwayn kalyfrnya,eobain,er wan,ou wen,Ервайн,Ервајн,Ирвайн,Ирвин,Ървайн,אירוויין,إرفاين,اروائن,ارواین، کالیفرنیا,アーバイン,歐文,爾灣,어바인</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">33.66946</td>
<td style="text-align: right;">-117.82311</td>
<td style="text-align: left;">America/Los_Angeles</td>
<td style="text-align: right;">256927</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Moore</td>
<td style="text-align: left;">Mur,mu er,mua,mueo,mwr,mwr aklahma,Мур,مور,مور، اکلاهما,موور، اوکلاہوما,ムーア,穆尔,무어</td>
<td style="text-align: left;">OK</td>
<td style="text-align: left;">USA</td>
<td style="text-align: left;">US</td>
<td style="text-align: right;">35.33951</td>
<td style="text-align: right;">-97.48670</td>
<td style="text-align: left;">America/Chicago</td>
<td style="text-align: right;">60451</td>
<td style="text-align: right;">382</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="3" type="1">
<li>day_parts_map (showing the first 12 observations)</li>
</ol>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(day_parts_map) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">rounded_lat</th>
<th style="text-align: right;">rounded_long</th>
<th style="text-align: left;">rounded_date</th>
<th style="text-align: left;">astronomical_twilight_begin</th>
<th style="text-align: left;">nautical_twilight_begin</th>
<th style="text-align: left;">civil_twilight_begin</th>
<th style="text-align: left;">sunrise</th>
<th style="text-align: left;">solar_noon</th>
<th style="text-align: left;">sunset</th>
<th style="text-align: left;">civil_twilight_end</th>
<th style="text-align: left;">nautical_twilight_end</th>
<th style="text-align: left;">astronomical_twilight_end</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-80</td>
<td style="text-align: left;">2022-08-28</td>
<td style="text-align: left;">09:07:43</td>
<td style="text-align: left;">09:42:49</td>
<td style="text-align: left;">10:16:18</td>
<td style="text-align: left;">10:42:53</td>
<td style="text-align: left;">17:21:10</td>
<td style="text-align: left;">23:59:27</td>
<td style="text-align: left;">00:26:02</td>
<td style="text-align: left;">00:59:31</td>
<td style="text-align: left;">01:34:37</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-90</td>
<td style="text-align: left;">2022-08-21</td>
<td style="text-align: left;">09:38:33</td>
<td style="text-align: left;">10:14:53</td>
<td style="text-align: left;">10:49:12</td>
<td style="text-align: left;">11:16:15</td>
<td style="text-align: left;">18:03:05</td>
<td style="text-align: left;">00:49:55</td>
<td style="text-align: left;">01:16:58</td>
<td style="text-align: left;">01:51:17</td>
<td style="text-align: left;">02:27:37</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-80</td>
<td style="text-align: left;">2022-08-14</td>
<td style="text-align: left;">08:48:54</td>
<td style="text-align: left;">09:26:40</td>
<td style="text-align: left;">10:01:56</td>
<td style="text-align: left;">10:29:32</td>
<td style="text-align: left;">17:24:39</td>
<td style="text-align: left;">00:19:45</td>
<td style="text-align: left;">00:47:21</td>
<td style="text-align: left;">01:22:37</td>
<td style="text-align: left;">02:00:24</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-90</td>
<td style="text-align: left;">2022-08-07</td>
<td style="text-align: left;">09:19:00</td>
<td style="text-align: left;">09:58:23</td>
<td style="text-align: left;">10:34:41</td>
<td style="text-align: left;">11:02:53</td>
<td style="text-align: left;">18:05:45</td>
<td style="text-align: left;">01:08:37</td>
<td style="text-align: left;">01:36:50</td>
<td style="text-align: left;">02:13:08</td>
<td style="text-align: left;">02:52:31</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">-120</td>
<td style="text-align: left;">2022-08-07</td>
<td style="text-align: left;">11:55:02</td>
<td style="text-align: left;">12:26:50</td>
<td style="text-align: left;">12:57:22</td>
<td style="text-align: left;">13:21:39</td>
<td style="text-align: left;">20:05:45</td>
<td style="text-align: left;">02:49:51</td>
<td style="text-align: left;">03:14:07</td>
<td style="text-align: left;">03:44:39</td>
<td style="text-align: left;">04:16:27</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">-100</td>
<td style="text-align: left;">2022-07-24</td>
<td style="text-align: left;">09:39:05</td>
<td style="text-align: left;">10:22:03</td>
<td style="text-align: left;">11:00:33</td>
<td style="text-align: left;">11:30:01</td>
<td style="text-align: left;">18:46:32</td>
<td style="text-align: left;">02:03:03</td>
<td style="text-align: left;">02:32:31</td>
<td style="text-align: left;">03:11:02</td>
<td style="text-align: left;">03:54:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The full description of the variables can be found <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-06-20/readme.md">here</a>.</p>
<p>I found the following questions interesting so I explored them visually.</p>
</section>
<section id="what-are-the-time-trends-in-the-sighting-of-ufos" class="level2">
<h2 class="anchored" data-anchor-id="what-are-the-time-trends-in-the-sighting-of-ufos">What are the time trends in the sighting of UFOs?</h2>
<p>We explore how the frequency of sightings of UFOs varies by year (since 1925), month and day of the month in 3 visualizations.</p>
<div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="fu">month</span>(reported_date_time_utc, <span class="at">abbr =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">day =</span> <span class="fu">day</span>(reported_date_time_utc),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">year</span>(reported_date_time_utc))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot frequency of UFOs by year</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">xend =</span> year, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of UFOs by month</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>month, <span class="at">xend =</span> month, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a> <span class="co"># frequency of UFOs by day of the month</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(day) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">xend =</span> day, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/time-trends-1.png" class="img-fluid figure-img" alt="A lollipop graph showing the Frequency of sightings of Unidentified Flying Objects (UFOs) by year, month and day. The graph for year shows a rapid increase in sightings of UFOs towards the late 20th and early 21st centuries." width="672"></p>
<p></p><figcaption class="figure-caption">Frequency of UFOs sightings by year</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 45.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/time-trends-2.png" class="img-fluid figure-img" alt="A lollipop graph showing the Frequency of sightings of Unidentified Flying Objects (UFOs) by year, month and day. The graph for year shows a rapid increase in sightings of UFOs towards the late 20th and early 21st centuries." width="672"></p>
<p></p><figcaption class="figure-caption">Frequency of UFOs sightings by month</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 10.0%;justify-content: center;">
<p>&nbsp;</p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 45.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/time-trends-3.png" class="img-fluid figure-img" alt="A lollipop graph showing the Frequency of sightings of Unidentified Flying Objects (UFOs) by year, month and day. The graph for year shows a rapid increase in sightings of UFOs towards the late 20th and early 21st centuries." width="672"></p>
<p></p><figcaption class="figure-caption">Frequency of UFOs sightings by day of the month</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 45.0%;justify-content: center;">
<p>Frequency of sightings of UFOs by year, month and day of the month</p>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 10.0%;justify-content: center;">
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<p>The frequency of sightings of UFOs increased late in the 20<sup>th</sup> century and rapidly increased early in the 21<sup>st</sup> century.</p>
</section>
<section id="which-countries-and-cities-most-commonly-report-sightings-of-ufos" class="level2">
<h2 class="anchored" data-anchor-id="which-countries-and-cities-most-commonly-report-sightings-of-ufos">Which countries and cities most commonly report sightings of UFOs?</h2>
<p>We plot the world map filled with colors proportional to the frequency of sightings of UFOs. I found <a href="https://r-spatial.org//r/2018/10/25/ggplot2-sf.html">this</a> tutorial on drawing maps programmatically super helpful.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Ufo_country <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ufo_countries_sf <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">left_join</span>(Ufo_country, <span class="at">by =</span> <span class="fu">join_by</span>(postal <span class="sc">==</span> country_code))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ufo_countries_sf, <span class="fu">aes</span>(<span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Frequency"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/maps-world-1.png" class="img-fluid figure-img" alt="A world map showing the frequency of sightings of Unidentified Flying Objects (UFOs) across the world. The United States of America and Alaska have the highest frequency of reported UFOs sightings." width="672"></p>
<p></p><figcaption class="figure-caption">Frequency of sightings of UFOs across the world.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Most of reports of UFOs sightings are from the United States of America (USA) and Alaska. Fewer sightings are reported from the rest of the world. There is a huge difference in the order of magnitude of the frequency of UFOs sightings with a maximum of 88213 and minimum of 1. The color fill is strained to capture that monstrous difference. We can apply a logarithmic transformation to show orders of magnitude.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ufo_countries_sf, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log</span>(n))) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Frequency (logarithm)"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/maps-world-log-transformed-1.png" class="img-fluid figure-img" alt="A world map showing the log frequency of sightings of Unidentified Flying Objects (UFOs) across the world. In addition to the United States of America and Alaska, Canada and Australia also have relatively high frequency of reported UFOs sightings." width="672"></p>
<p></p><figcaption class="figure-caption">Frequency of sightings of UFOs across the world applying a log transformation</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>This map reveals that in addition to the USA and Alaska, Canada and Australia also have a relatively high frequency of UFOs sightings.</p>
<section id="cities-in-africa" class="level3">
<h3 class="anchored" data-anchor-id="cities-in-africa">Cities (in Africa)</h3>
<p>Sightings of UFOs were reported from 10721 unique cities! The top 5 cities with the most reported sightings of UFOs are:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ufo_sightings <span class="sc">|&gt;</span> <span class="fu">group_by</span>(city) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Table showing the top 5 cities with the most reported sightings of UFOs </caption>
<thead>
<tr class="header">
<th style="text-align: left;">city</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">667</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phoenix</td>
<td style="text-align: right;">634</td>
</tr>
<tr class="even">
<td style="text-align: left;">Las Vegas</td>
<td style="text-align: right;">553</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Portland</td>
<td style="text-align: right;">541</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It is not feasible to display all 10721 cities on a single world map. So I’ll chose one region Africa in particular. Partly because I’m a proud African and partly because I’m interested in what surprises we shall uncover in a region with relatively low UFOs sightings.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get African country codes from the world dataset. Names came out as attributes to the vector of country codes.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>africa_codes <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Africa"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(postal, name)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter those African countries with UFO sightings </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ufo_africa <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="sc">!!</span>africa_codes) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get a subset of the world data for plotting the African continent</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ufo_africa_sf <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Africa"</span>) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(Ufo_country, <span class="at">by =</span> <span class="fu">join_by</span>(postal <span class="sc">==</span> country_code))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># convert places to sf for cities as points</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>places_sf <span class="ot">&lt;-</span> places <span class="sc">|&gt;</span> <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="sc">!!</span> africa_codes) <span class="sc">|&gt;</span> <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute centroids where country labels will be placed</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>centriod_coordinates <span class="ot">&lt;-</span> ufo_africa_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(postal <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code) <span class="sc">|&gt;</span> <span class="fu">st_centroid</span>() <span class="sc">|&gt;</span> <span class="fu">st_coordinates</span>() </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the centriod coordinates with the sf_object subset</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ufo_africa_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(postal <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code), centriod_coordinates)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># nudge south Africa to the left (to avoid obscuring Lesotho's label)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids<span class="sc">$</span>nudge_X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids<span class="sc">$</span>nudge_X[countries_sf_centroids<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"South Africa"</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ufo_africa_sf) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log</span>(n))) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> places_sf, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> countries_sf_centroids, <span class="fu">aes</span>(X, Y, <span class="at">label =</span> name), <span class="at">size =</span> <span class="fl">1.8</span>, <span class="at">nudge_x =</span> countries_sf_centroids<span class="sc">$</span>nudge_X) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> stringr<span class="sc">::</span><span class="fu">str_wrap</span>(<span class="st">"Map of Africa showing the countries with reported sightings of Unidentified Flying Objects (UFOs)"</span>, <span class="at">width =</span> <span class="dv">80</span>), <span class="at">subtitle =</span> stringr<span class="sc">::</span><span class="fu">str_wrap</span>(<span class="st">"The colors are proportional to the natural logarithm of the frequency of reports. Dark dots are the locations where UFOs were sighted. Labels are the country names."</span>, <span class="at">width =</span> <span class="dv">90</span>) ,<span class="at">caption =</span> <span class="st">"Data: Sightings of UFOs 2023 | Graphic: @Emmanuelmiiro25"</span>, <span class="at">fill =</span> <span class="st">"Frequency (logarithm)"</span>) <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Latitude"</span>) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"bl"</span>, <span class="at">which_north =</span> <span class="st">"true"</span>, </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.75</span>, <span class="st">"in"</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"in"</span>),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> north_arrow_fancy_orienteering)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UFO-plots_files/figure-html/map-africa-1.png" class="img-fluid figure-img" alt="A map of Africa showing countries with reports of sightings of UFOs. The color fill is proportionate to the natural logarithm of frequency of reports with yellow the highes and blue the lowest. South Africa has the highest frequency of reports." width="672"></p>
<p></p><figcaption class="figure-caption">Map of Africa showing the countries with reports of sightings of Unidentified Flying Objects (UFOs). The colors are proportional to the natural logarithm of the frequency of reports. Dark dots are the locations where UFOs were sighted. Labels are the country names.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>South Africa has the highest number of reports of sightings of UFOs, followed by Egypt. Interestingly, the relatively small island of Cape Verde also reported sighting a UFO! The table below shows the top 5 African countries with the most sightings of UFOs.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rank the top 5 African countries with sightings of UFOs</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ufo_africa <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">country_name =</span> xfun<span class="sc">::</span><span class="fu">attr</span>(africa_codes[africa_codes <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code], <span class="at">which =</span> <span class="st">"names"</span>)) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>This table shows the top 5 African countries with most reported sightings (n) of Unidentified Flying Objects (UFOs) </caption>
<thead>
<tr class="header">
<th style="text-align: left;">country_code</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">country_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ZA</td>
<td style="text-align: right;">122</td>
<td style="text-align: left;">South Africa</td>
</tr>
<tr class="even">
<td style="text-align: left;">EG</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">Egypt</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NG</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Nigeria</td>
</tr>
<tr class="even">
<td style="text-align: left;">KE</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Kenya</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MA</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Morocco</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>That’s it for this week’s /#TidyTuesday.</p>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Plots for UFO sightings"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Dr. Miiro Emmanuel</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-06-20</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> short</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-packages</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"sf"</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rnaturalearth"</span>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"rnaturalearthdata"</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>ufo_sightings <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ufo_sightings.csv"</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>places <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"places.csv"</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>day_parts_map <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2023-06-20"</span>,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">"day_parts_map.csv"</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="fu"># Sightings of Unidentified Flying Objects (UFOs)</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>The data on sightings of UFOs was collated by <span class="co">[</span><span class="ot">Jon Harmon</span><span class="co">](https://github.com/jonthegeek/apis/)</span> from the <span class="co">[</span><span class="ot">National UFO Reporting Center</span><span class="co">](https://nuforc.org/webreports/ndxshape.html)</span>. He enriched the data with additional features. It was provided as part of the weekly <span class="co">[</span><span class="ot">TidyTuesday challenge</span><span class="co">](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-06-20/readme.md)</span>.</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structure of the data</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>The data has <span class="in">`r nrow(ufo_sightings)`</span> observations. It was provided in 3 parts:</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>ufo_sightings (showing the first 12 observations)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: check-ufo-sightings</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ufo_sightings) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>places (showing the first 12 observations)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: check-places</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(places) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>day_parts_map (showing the first 12 observations)</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: check-day-places</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(day_parts_map) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>The full description of the variables can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-06-20/readme.md)</span>.</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>I found the following questions interesting so I explored them visually.</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## What are the time trends in the sighting of UFOs?</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>We explore how the frequency of sightings of UFOs varies by year (since <span class="in">`r min(year(ufo_sightings$reported_date_time_utc))`</span>), month and day of the month in 3 visualizations.</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: time-trends</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout: [[100], [45,-10, 45]]</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Frequency of sightings of UFOs by year, month and day of the month"</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| - "Frequency of UFOs sightings by year"</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| - "Frequency of UFOs sightings by month"</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| - "Frequency of UFOs sightings by day of the month"</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "A lollipop graph showing the Frequency of sightings of Unidentified Flying Objects (UFOs) by year, month and day. The graph for year shows a rapid increase in sightings of UFOs towards the late 20th and early 21st centuries."</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">month =</span> <span class="fu">month</span>(reported_date_time_utc, <span class="at">abbr =</span> <span class="cn">TRUE</span>), </span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">day =</span> <span class="fu">day</span>(reported_date_time_utc),</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">year</span>(reported_date_time_utc))</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a><span class="co"># plot frequency of UFOs by year</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">xend =</span> year, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of UFOs by month</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>month, <span class="at">xend =</span> month, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a> <span class="co"># frequency of UFOs by day of the month</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>ufos_time <span class="sc">|&gt;</span> <span class="fu">group_by</span>(day) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"cyan"</span>, <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"orange"</span>, <span class="fl">0.3</span>), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">stroke=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">xend =</span> day, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> n)) <span class="sc">+</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of UFOs sightings"</span>) </span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>The frequency of sightings of UFOs increased late in the 20^th^ century and rapidly increased early in the 21^st^ century.</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Which countries and cities most commonly report sightings of UFOs?</span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>We plot the world map filled with colors proportional to the frequency of sightings of UFOs. I found <span class="co">[</span><span class="ot">this</span><span class="co">](https://r-spatial.org//r/2018/10/25/ggplot2-sf.html)</span> tutorial on drawing maps programmatically super helpful.</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: maps-world</span></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Frequency of sightings of UFOs across the world."</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "A world map showing the frequency of sightings of Unidentified Flying Objects (UFOs) across the world. The United States of America and Alaska have the highest frequency of reported UFOs sightings."</span></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>Ufo_country <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> </span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_code) <span class="sc">|&gt;</span> </span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>ufo_countries_sf <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">left_join</span>(Ufo_country, <span class="at">by =</span> <span class="fu">join_by</span>(postal <span class="sc">==</span> country_code))</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ufo_countries_sf, <span class="fu">aes</span>(<span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>Most of reports of UFOs sightings are from the United States of America (USA) and Alaska. Fewer sightings are reported from the rest of the world. There is a huge difference in the order of magnitude of the frequency of UFOs sightings with a maximum of <span class="in">`r max(Ufo_country$n)`</span> and minimum of <span class="in">`r min(Ufo_country$n)`</span>. The color fill is strained to capture that monstrous difference. We can apply a logarithmic transformation to show orders of magnitude.</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: maps-world-log-transformed</span></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Frequency of sightings of UFOs across the world applying a log transformation"</span></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "A world map showing the log frequency of sightings of Unidentified Flying Objects (UFOs) across the world. In addition to the United States of America and Alaska, Canada and Australia also have relatively high frequency of reported UFOs sightings."</span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world) <span class="sc">+</span></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ufo_countries_sf, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log</span>(n))) <span class="sc">+</span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Frequency (logarithm)"</span>) </span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>This map reveals that in addition to the USA and Alaska, Canada and Australia also have a relatively high frequency of UFOs sightings.</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cities (in Africa)</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>Sightings of UFOs were reported from <span class="in">`r length(unique(places$city))`</span> unique cities! The top 5 cities with the most reported sightings of UFOs are:</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cities-ranked-tbl</span></span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Table showing the top 5 cities with the most reported sightings of UFOs</span></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>ufo_sightings <span class="sc">|&gt;</span> <span class="fu">group_by</span>(city) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>It is not feasible to display all <span class="in">`r length(unique(places$city))`</span> cities on a single world map. So I'll chose one region Africa in particular. Partly because I'm a proud African and partly because I'm interested in what surprises we shall uncover in a region with relatively low UFOs sightings.</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: map-africa</span></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Map of Africa showing the countries with reports of sightings of Unidentified Flying Objects (UFOs). The colors are proportional to the natural logarithm of the frequency of reports. Dark dots are the locations where UFOs were sighted. Labels are the country names.</span></span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: A map of Africa showing countries with reports of sightings of UFOs. The color fill is proportionate to the natural logarithm of frequency of reports with yellow the highes and blue the lowest. South Africa has the highest frequency of reports.</span></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a><span class="co"># get African country codes from the world dataset. Names came out as attributes to the vector of country codes.</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>africa_codes <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Africa"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(postal, name)</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a><span class="co"># filter those African countries with UFO sightings </span></span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>ufo_africa <span class="ot">&lt;-</span> ufo_sightings <span class="sc">|&gt;</span> <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="sc">!!</span>africa_codes) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(country_code) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="co"># get a subset of the world data for plotting the African continent</span></span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>ufo_africa_sf <span class="ot">&lt;-</span> world <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Africa"</span>) <span class="sc">|&gt;</span> <span class="fu">left_join</span>(Ufo_country, <span class="at">by =</span> <span class="fu">join_by</span>(postal <span class="sc">==</span> country_code))</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a><span class="co"># convert places to sf for cities as points</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>places_sf <span class="ot">&lt;-</span> places <span class="sc">|&gt;</span> <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="sc">!!</span> africa_codes) <span class="sc">|&gt;</span> <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) </span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a><span class="co"># compute centroids where country labels will be placed</span></span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>centriod_coordinates <span class="ot">&lt;-</span> ufo_africa_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(postal <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code) <span class="sc">|&gt;</span> <span class="fu">st_centroid</span>() <span class="sc">|&gt;</span> <span class="fu">st_coordinates</span>() </span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the centriod coordinates with the sf_object subset</span></span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ufo_africa_sf <span class="sc">|&gt;</span> <span class="fu">filter</span>(postal <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code), centriod_coordinates)</span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a><span class="co"># nudge south Africa to the left (to avoid obscuring Lesotho's label)</span></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids<span class="sc">$</span>nudge_X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>countries_sf_centroids<span class="sc">$</span>nudge_X[countries_sf_centroids<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"South Africa"</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ufo_africa_sf) <span class="sc">+</span></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log</span>(n))) <span class="sc">+</span></span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> places_sf, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>) <span class="sc">+</span></span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> countries_sf_centroids, <span class="fu">aes</span>(X, Y, <span class="at">label =</span> name), <span class="at">size =</span> <span class="fl">1.8</span>, <span class="at">nudge_x =</span> countries_sf_centroids<span class="sc">$</span>nudge_X) <span class="sc">+</span></span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> stringr<span class="sc">::</span><span class="fu">str_wrap</span>(<span class="st">"Map of Africa showing the countries with reported sightings of Unidentified Flying Objects (UFOs)"</span>, <span class="at">width =</span> <span class="dv">80</span>), <span class="at">subtitle =</span> stringr<span class="sc">::</span><span class="fu">str_wrap</span>(<span class="st">"The colors are proportional to the natural logarithm of the frequency of reports. Dark dots are the locations where UFOs were sighted. Labels are the country names."</span>, <span class="at">width =</span> <span class="dv">90</span>) ,<span class="at">caption =</span> <span class="st">"Data: Sightings of UFOs 2023 | Graphic: @Emmanuelmiiro25"</span>, <span class="at">fill =</span> <span class="st">"Frequency (logarithm)"</span>) <span class="sc">+</span></span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> </span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Latitude"</span>) <span class="sc">+</span></span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"bl"</span>, <span class="at">which_north =</span> <span class="st">"true"</span>, </span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>        <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.75</span>, <span class="st">"in"</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"in"</span>),</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> north_arrow_fancy_orienteering)</span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>South Africa has the highest number of reports of sightings of UFOs, followed by Egypt. Interestingly, the relatively small island of Cape Verde also reported sighting a UFO!</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>The table below shows the top 5 African countries with the most sightings of UFOs.</span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: African-countries-ranked</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: This table shows the top 5 African countries with most reported sightings (n) of Unidentified Flying Objects (UFOs)</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a><span class="co"># rank the top 5 African countries with sightings of UFOs</span></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>ufo_africa <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">country_name =</span> xfun<span class="sc">::</span><span class="fu">attr</span>(africa_codes[africa_codes <span class="sc">%in%</span> ufo_africa<span class="sc">$</span>country_code], <span class="at">which =</span> <span class="st">"names"</span>)) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>That's it for this week's /#TidyTuesday.</span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>